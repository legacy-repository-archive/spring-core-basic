# ë¹ˆ ìŠ¤ì½”í”„ë€?      
ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ì‹œì‘ê³¼ í•¨ê»˜ ìƒì„±ë˜ì–´, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ ê¹Œì§€ ìœ ì§€ëœë‹¤ê³  ì•Œê³ ìˆë‹¤.  
**ê·¸ëŸ°ë° ì´ ë¹ˆì˜ ìƒëª…ì£¼ê¸°ë¥¼ ê¼­ í”„ë¡œê·¸ë¨ì˜ ì‹œì‘ê³¼ ì¢…ë£Œê¹Œì§€ë¡œ ì¡´ì¬ì‹œì¼œì•¼ í• ê¹Œ?ğŸ¤”**             
                   
ê¸°ì¡´ì— ìš°ë¦¬ê°€ ì•Œê³  ìˆëŠ” ë°©ì‹ì€ ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ì´ë‹¤.         
ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ëŠ” ìŠ¤í”„ë§ì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ìŠ¤ì½”í”„ë¡œ í”„ë¡œê·¸ë¨ì˜ ì‹œì‘ê³¼ ì¢…ë£Œê¹Œì§€ ì¡´ì¬í•œë‹¤.      
í•˜ì§€ë§Œ, `ìŠ¤ì½”í”„`ë¼ëŠ” ì´ë¦„ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ ë²”ìœ„ì˜ í•œ ì¢…ë¥˜ì¼ ë¿ì´ë‹¤.   
ì¦‰, ìŠ¤í”„ë§ì—ì„œëŠ” ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ ì™¸ì— ë‹¤ë¥¸ ìŠ¤ì½”í”„ë“¤ë„ ì¡´ì¬í•œë‹¤.   
       
**ìŠ¤í”„ë§ì€ ë‹¤ìŒê³¼ ê°™ì€ ë‹¤ì–‘í•œ ìŠ¤ì½”í”„ë¥¼ ì§€ì›í•œë‹¤.**     
* **Singletone:** ê¸°ë³¸ ìŠ¤ì½”í”„, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ì‹œì‘ê³¼ ì¢…ë£Œê¹Œì§€ ìœ ì§€ë˜ëŠ” ê°€ì¥ ë„“ì€ ë²”ìœ„ì˜ ìŠ¤ì½”í”„ì´ë‹¤.      
* **prototype:** ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì˜ ìƒì„±ê³¼ ì˜ì¡´ê´€ê³„ ì£¼ì…ê¹Œì§€ë§Œ ê´€ì—¬í•˜ê³  ë”ëŠ” ê´€ë¦¬í•˜ì§€ ì•ŠëŠ” ë§¤ìš° ì§§ì€ ë²”ìœ„ì˜ ìŠ¤ì½”í”„ì´ë‹¤.     
* **request:** ì›¹ ìš”ì²­ì´ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„ì´ë‹¤.    
* **session:** ì›¹ ì„¸ì…˜ì´ ìƒì„±ë˜ê³  ì¢…ë£Œë  ë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„ì´ë‹¤.    
* **application:** ì›¹ì˜ ì„œë¸”ë¦¿ ì»¨í…ìŠ¤ì™€ ê°™ì€ ë²”ìœ„ë¡œ ìœ ì§€ë˜ëŠ” ìŠ¤ì½”í”„ì´ë‹¤.    
    
ì´ëŸ¬í•œ ë¹ˆ ìŠ¤ì½”í”„ëŠ” `@Scope`ë¼ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©°       
ë¹ˆ ë“±ë¡ì‹œ ì„¤ì •í•˜ëŠ” ê²ƒì´ê¸°ì— `@Bean`ì–´ë…¸í…Œì´ì…˜ê³¼ í•¨ê»˜ ì‚¬ìš©í•´ì•¼í•œë‹¤.          
   
**ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ë“±ë¡**
```java
@Scope("prototype")
@Component
public class HelloBean {}
```
   
**ìˆ˜ë™ ë“±ë¡**
```java
@Scope("prototype")
@Bean
PrototypeBean HelloBean() {
    return new HelloBean();
}
```

# í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„    
ë¹ˆì„ ìš”ì²­í•  ë•Œë§ˆë‹¤, ë§¤ë²ˆ ê°™ì€ ë¹ˆê³¼ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì„ ë§ºëŠ” ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ì™€ ë‹¬ë¦¬,        
í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ëŠ” ë¹ˆì„ ìš”ì²­í•  ë•Œë§ˆë‹¤ ë§¤ë²ˆ ìƒˆë¡­ê²Œ ìƒì„±ëœ ë¹ˆê³¼ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì„ ë§ºëŠ”ë‹¤.    
           
ë” ìƒì„¸í•˜ê²Œ ì„¤ëª…í•˜ìë©´,               
í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì€ **ë¹ˆ ìƒì„± ê³¼ì • ë° ì‚¬ìš©**ê¹Œì§€ëŠ” ì‹±ê¸€í†¤ ë¹ˆê³¼ ë™ì¼í•˜ê¸°ì—             
**ë¹ˆ ìƒì„± -> ì˜ì¡´ ê´€ê³„ ì£¼ì… -> ì´ˆê¸°í™”** ë‹¨ê³„ ê¹Œì§€ëŠ” ë™ì¼í•˜ê²Œ ì ìš©ë˜ë‚˜               
ì´í›„ ë¶€í„°ëŠ” ìŠ¤í”„ë§ì—ì„œ ë¹ˆì„ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì „ëµì„ ê°€ì§€ê³  ìˆë‹¤.                
ê·¸ë¦¬ê³  ë¯¸ë¦¬ ìƒì„±ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë¹ˆì„ ìš”ì²­í•  ë•Œ ìƒì„±í•œë‹¤ëŠ” íŠ¹ì§•ë„ ê°€ì§€ê³  ìˆë‹¤.         
         
ì¦‰, ì´ˆê¸°í™” ì´í›„ì—ëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ë¹ˆì„ ê´€ë¦¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—       
í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë¹ˆì„ ê´€ë¦¬í•´ì•¼í•œë‹¤ëŠ” ì±…ì„ì„ ë„˜ê²¨ë°›ê²Œ ëœë‹¤.      
ê·¸ë¦¬ê³  ì´ë¡œì¸í•´ `PreDestroy` ê°™ì€ ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì§€ë„ ì•ŠëŠ”ë‹¤.           
      
**SingletonTest**   
```java
package hello.core.scope;

import org.junit.jupiter.api.Test;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;

import static org.assertj.core.api.Assertions.assertThat;

public class SingletonTest {

    @Test
    void singletonBeanFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(SingletonBean.class);

        SingletonBean singletonBean1 = ac.getBean(SingletonBean.class);
        SingletonBean singletonBean2 = ac.getBean(SingletonBean.class);

        System.out.println("singletonBean1 = " + singletonBean1);
        System.out.println("singletonBean2 = " + singletonBean2);

        assertThat(singletonBean1).isSameAs(singletonBean2);

        ac.close();
    }


    @Scope(scopeName = "singleton")
    static class SingletonBean {

        @PostConstruct
        public void init() {
            System.out.println("SingletonBean.init");
        }

        @PreDestroy
        public void destroy() {
            System.out.println("SingletonBean.destroy");
        }

    }
}
```
   
**PrototypeTest**
```java
package hello.core.scope;

import org.junit.jupiter.api.Test;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;

import static org.assertj.core.api.Assertions.assertThat;

public class PrototypeTest {

    @Test
    void prototypeBeanFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);

        System.out.println("find prototypeBean1, bean is create at this request time");
        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);

        System.out.println("find prototypeBean2, bean is create at this request time");
        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);

        System.out.println("singletonBean1 = " + prototypeBean1);
        System.out.println("singletonBean2 = " + prototypeBean2);

        assertThat(prototypeBean1).isNotSameAs(prototypeBean2);

        ac.close();
    }


    @Scope(scopeName = "prototype")
    static class PrototypeBean {

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init");
        }

        @PreDestroy
        public void destroy() {
            System.out.println("PrototypeBean.destroy");
        }

    }
}
```
      
ì‹±ê¸€í†¤ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„± ì‹œì ì— ì´ˆê¸°í™” ë©”ì„œë“œê°€ ì‹¤í–‰ ë˜ì§€ë§Œ,         
**í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ë¹ˆì„ ì¡°íšŒí•  ë•Œ ìƒì„±ë˜ê³ , ì´ˆê¸°í™” ë©”ì„œë“œë„ ì‹¤í–‰ëœë‹¤.**           
í”„ë¡œí† íƒ€ì… ë¹ˆì„ 2ë²ˆ ì¡°íšŒí–ˆìœ¼ë¯€ë¡œ ì™„ì „íˆ ë‹¤ë¥¸ ìŠ¤í”„ë§ ë¹ˆì´ ìƒì„±ë˜ê³ , ì´ˆê¸°í™”ë„ 2ë²ˆ ì‹¤í–‰ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.    
         
ì‹±ê¸€í†¤ ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì— ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ ë¹ˆì˜ ì¢…ë£Œ ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ì§€ë§Œ,      
í”„ë¡œí† íƒ€ì… ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ìƒì„±ê³¼ ì˜ì¡´ê´€ê³„ ì£¼ì… ê·¸ë¦¬ê³  ì´ˆê¸°í™” ê¹Œì§€ë§Œ ê´€ì—¬í•˜ê³ , ë”ëŠ” ê´€ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤.       
ë”°ë¼ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ì¢…ë£Œë  ë•Œ @PreDestory ê°™ì€ ì¢…ë£Œ ë©”ì„œë“œê°€ ì „í˜€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.    
         
**í”„ë¡œí† íƒ€ì… ë¹ˆì˜ íŠ¹ì§• ì •ë¦¬**      
* ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìš”ì²­í•  ë•Œ ë§ˆë‹¤ ìƒˆë¡œ ìƒì„±ëœë‹¤.   
* ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í”„ë¡œí† íƒ€ì… ë¹ˆì˜ ìƒì„±ê³¼ ì˜ì¡´ê´€ê³„ ì£¼ì… ê·¸ë¦¬ê³  ì´ˆê¸°í™”ê¹Œì§€ë§Œ ê´€ì—¬í•œë‹¤.    
* ì¢…ë£Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.    
* ê·¸ë˜ì„œ í”„ë¡œí† íƒ€ì… ë¹ˆì€ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì¡°íšŒí•œ í´ë¼ì´ì–¸íŠ¸ê°€ ê´€ë¦¬í•´ì•¼ í•œë‹¤.      
* ì¢…ë£Œ ë©”ì„œë“œì— ëŒ€í•œ í˜¸ì¶œë„ í´ë¼ì´ì–¸íŠ¸ê°€ ì§ì ‘ í•´ì•¼í•œë‹¤.    
  
# í”„ë¡œí† íƒ€ì…ê³¼ ì‹±ê¸€í†¤ ë¹ˆê³¼ í•¨ê»˜ ì‚¬ìš©ì‹œ ë¬¸ì œì      
í”„í† í† íƒ€ì… ìŠ¤ì½”í”„ì˜ ë¹ˆì„ ìš”ì²­í•˜ë©´ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” í•­ìƒ ìƒˆë¡œìš´ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ì„œ ë°˜í™˜í•œë‹¤.               
í•˜ì§€ë§Œ, **`ì‹±ê¸€í†¤ ìŠ¤ì½”í”„ ë¹ˆ`ë‚´ì— `í”„ë¡œí† íƒ€ì… ìŠ¤ì½”í”„ ë¹ˆ`ì´ ì¡´ì¬í•œë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œ? ğŸ¤”**                  
ìš°ë¦¬ê°€ ì›í•˜ëŠ”ëŒ€ë¡œ ì‹±ê¸€í„´ì€ ì‹±ê¸€í„´ëŒ€ë¡œ, í”„ë¡œí† íƒ€ì…ì€ í”„ë¡œí† íƒ€ì… ë¹ˆëŒ€ë¡œ ì‹¤í–‰ì´ ë ê¹Œ?      
   
**SingletonWithPrototypeTest1**
```java
package hello.core.scope;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;

import static org.assertj.core.api.Assertions.assertThat;

public class SingletonWithPrototypeTest1 {

    @Test
    void prototypeFind() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(PrototypeBean.class);

        PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
        prototypeBean1.addCount();
        assertThat(prototypeBean1.getCount()).isEqualTo(1);

        PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
        prototypeBean2.addCount();
        assertThat(prototypeBean2.getCount()).isEqualTo(1);
    }

    @Test
    void singletonClientUsePrototype() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);

        ClientBean clientBean1 = ac.getBean(ClientBean.class);
        ClientBean clientBean2 = ac.getBean(ClientBean.class);

        assertThat(clientBean1.logic()).isEqualTo(1);
        assertThat(clientBean2.logic()).isEqualTo(2);

    }


    @Scope("singleton")
    static class ClientBean {
        private final PrototypeBean prototypeBean;

        @Autowired
        public ClientBean(PrototypeBean prototypeBean) {
            this.prototypeBean = prototypeBean;
        }

        public int logic() {
            prototypeBean.addCount();
            return prototypeBean.getCount();
        }

    }

    @Scope("prototype")
    static class PrototypeBean {
        private int count = 0;

        public void addCount() {
            count++;
        }

        public int getCount() {
            return count;
        }

        @PostConstruct
        public void init() {
            System.out.println("PrototypeBean.init " + this);
        }

        @PreDestroy
        public void destroy() {
            System.out.println("PrototypeBean.destroy");
        }
    }
}
```
```java
    @Test
    void singletonClientUsePrototype() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);

        ClientBean clientBean1 = ac.getBean(ClientBean.class);
        ClientBean clientBean2 = ac.getBean(ClientBean.class);

        assertThat(clientBean1.logic()).isEqualTo(1);
        assertThat(clientBean2.logic()).isEqualTo(2);

    }
```
ìœ„ ì½”ë“œì˜ ë‚´ë¶€ ë™ì‘ì— ëŒ€í•´ì„œ ì„¤ëª…í•´ë³´ìë©´ `ClientBean` ë¹ˆì„ ë§Œë“¤ë©´ì„œ   
`í”„ë¡œí† íƒ€ì… ë¹ˆ`ì¸ `PrototypeBean`ì„ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì„ ë°›ëŠ”ë‹¤.    

```java
    @Scope("singleton")
    static class ClientBean {
        private final PrototypeBean prototypeBean;

        @Autowired
        public ClientBean(PrototypeBean prototypeBean) {
            this.prototypeBean = prototypeBean;
        }

        public int logic() {
            prototypeBean.addCount();
            return prototypeBean.getCount();
        }

    }
```    
í•˜ì§€ë§Œ, `ClientBean`ì€ ìƒì„±ê³¼ ë™ì‹œì— `ì˜ì¡´ ê´€ê³„ ì£¼ì…`ì„ ì§„í–‰í•˜ê³  ìˆë‹¤.     
ê·¸ë ‡ê¸°ì— `í”„ë¡œí† íƒ€ì… ë¹ˆ`ì´ë¼ë„, ê²°ê³¼ì ìœ¼ë¡œ ë°˜í™˜ë˜ëŠ” `ClientBean`ì€ ì´ë¯¸ ìƒì„±ëœ ì‹±ê¸€í†¤ì´ë¯€ë¡œ    
í”„ë¡œí† íƒ€ì…ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•Šê³ , ë§ˆì¹˜ ì‹±ê¸€í†¤ì²˜ëŸ¼ ë™ì‘ì„ í•˜ëŠ” ë¹ˆì´ ë˜ì–´ë²„ë¦°ë‹¤.     

```java

    @Scope("singleton")
    static class ClientBean {
        private PrototypeBean prototypeBean;


        @Autowired
        public void setPrototypeBean(PrototypeBean prototypeBean) {
            this.prototypeBean = prototypeBean;
        }

        public int logic() {
            prototypeBean.addCount();
            return prototypeBean.getCount();
        }

    }
```
**ì°¸ê³ ë¡œ,** ìƒì„±ì ì£¼ì…ì„ ë°›ëŠ” ì½”ë“œë¥¼ Setter ì£¼ì…ìœ¼ë¡œ ë°”ê¾¸ì–´ë„ ê²°ê³¼ëŠ” ë§ˆì°¬ê°€ì§€ì´ë‹¤.   
     
ê·¸ë¦¬ê³  ìœ„ì—ì„œ `ë§ˆì¹˜ ì‹±ê¸€í†¤ì²˜ëŸ¼ ë™ì‘`ì„ í•œë‹¤ê³  ì´ì•¼ê¸°ë¥¼ í–ˆë‹¤.   
ì´ ë¶€ë¶„ì— ëŒ€í•´ì„œ ì¡°ê¸ˆ ì„¤ëª…í•´ë³´ê¸° ìœ„í•´, `PrototypeBean`ì„ ì˜ì¡´ ê´€ê³„ ì£¼ì…ë°›ëŠ” ê°ì²´ê°€ í•˜ë‚˜ ë” ìˆë‹¤ ê°€ì •í•œë‹¤.   

```java
    @Test
    void singletonClientUsePrototype() {
        AnnotationConfigApplicationContext ac = new AnnotationConfigApplicationContext(ClientBean.class, ClientBean2.class, PrototypeBean.class);

        ClientBean clientBean1 = ac.getBean(ClientBean.class);
        ClientBean2 clientBean2 = ac.getBean(ClientBean2.class);

        assertThat(clientBean1.logic()).isEqualTo(1);
        assertThat(clientBean2.logic()).isEqualTo(1);

    }


    @Scope("singleton")
    static class ClientBean {
        private PrototypeBean prototypeBean;


        @Autowired
        public void setPrototypeBean(PrototypeBean prototypeBean) {
            this.prototypeBean = prototypeBean;
        }

        public int logic() {
            prototypeBean.addCount();
            return prototypeBean.getCount();
        }

    }

    @Scope("singleton")
    static class ClientBean2 {
        private PrototypeBean prototypeBean;


        @Autowired
        public void setPrototypeBean(PrototypeBean prototypeBean) {
            this.prototypeBean = prototypeBean;
        }

        public int logic() {
            prototypeBean.addCount();
            return prototypeBean.getCount();
        }

    }
```
```java
PrototypeBean.init hello.core.scope.SingletonWithPrototypeTest1$PrototypeBean@11fc564b   
PrototypeBean.init hello.core.scope.SingletonWithPrototypeTest1$PrototypeBean@3f56875e  
```  
ì´ ê°™ì€ ê²½ìš°ëŠ” ë‘ ë¹ˆ ëª¨ë‘ ì‹±ê¸€í„´ì´ì§€ë§Œ,           
ì£¼ì…ë˜ëŠ” ë¹ˆì€ í”„ë¡œí† íƒ€ì… ë¹ˆì´ë¯€ë¡œ ê°ê°ì˜ ì˜ì¡´ ê´€ê³„ ì£¼ì…ì— ìƒˆë¡œìš´ ê°ì²´ë¡œ ìƒì„±ë˜ì–´ ì£¼ì…í•œë‹¤.         
     
# Dependecy Lookupì„ ìœ„í•œ Provider          
ì‹±ê¸€í†¤ ë¹ˆê³¼ í”„ë¡œí† íƒ€ì… ë¹ˆì„ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ,          
ì–´ë–»ê²Œ í•˜ë©´ ì‚¬ìš©í•  ë•Œ ë§ˆë‹¤ í•­ìƒ ìƒˆë¡œìš´ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ìƒì„±í•  ìˆ˜ ìˆì„ê¹Œ?        
         

```java
 static class ClientBean {
     @Autowired
     private ApplicationContext ac;
     
     public int logic() {
         PrototypeBean prototypeBean = ac.getBean(PrototypeBean.class);
         prototypeBean.addCount();
         int count = prototypeBean.getCount();
         return count;
     }
 }
```  
ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ìœ¼ë¡œëŠ” `ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë¹ˆ`ì„ ì˜ì¡´ ê´€ê³„ ì£¼ì…ë°›ì•„          
`ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë¹ˆ`ì˜ `getBean()`ì„ í™œìš©í•˜ì—¬ ì§ì ‘ í”„ë¡œí† íƒ€ì… ë¹ˆì„ êº¼ë‚´ì˜¤ë©´ ëœë‹¤.           
        
ì´ë ‡ë“¯, ì˜ì¡´ ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…(DI) ë°›ëŠ”ê²Œ ì•„ë‹ˆë¼      
**ì§ì ‘ í•„ìš”í•œ ì˜ì¡´ ê´€ê³„ë¥¼ ì°¾ëŠ” ê²ƒì„ Dependency Lookup (DL) ì˜ì¡´ê´€ê³„ ì¡°íšŒ(íƒìƒ‰)** ì´ë¼ í•œë‹¤.       
             
ê·¸ëŸ°ë° ì´ë ‡ê²Œ ìŠ¤í”„ë§ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ì „ì²´ë¥¼ ì£¼ì…ë°›ê²Œ ë˜ë©´,        
`ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ`ì— ì¢…ì†ì ì¸ ì½”ë“œê°€ ë˜ê³ , ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë„ ì–´ë ¤ì›Œì§„ë‹¤.       
          
ì§€ê¸ˆ í•„ìš”í•œ ê¸°ëŠ¥ì€ ì§€ì •í•œ í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì»¨í…Œì´ë„ˆì—ì„œ ëŒ€ì‹  ì°¾ì•„ì£¼ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ     
ë”±! DL ì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µí•˜ëŠ” ë¬´ì–¸ê°€ê°€ ìˆìœ¼ë©´ ëœë‹¤.     
   
## ObjectFactory, ObjectProvider   
ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ íŠ¹ì •í•œ ë¹ˆì„ ì°¾ì•„ì˜¬ ìˆ˜ ìˆëŠ” `ObjectProvider`ë¹ˆì´ ì¡´ì¬í•œë‹¤.     
  
```java
    @Autowired
    private ObjectProvider<PrototypeBean> prototypeBeanProvider;

    public int logic() {
        PrototypeBean prototypeBean = prototypeBeanProvider.getObject();
        prototypeBean.addCount();
        int count = prototypeBean.getCount();
        return count;
    }
```      
   
`prototypeBeanProvider.getObject()`ì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤. (DL)     
`ObjectProvider` ì˜ `getObject()` ë¥¼ í˜¸ì¶œí•˜ë©´ ë‚´ë¶€ì—ì„œëŠ” ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ë§Œ,          
ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê±°ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ë„ í›¨ì”¬ ì‰¬ì›Œì§„ë‹¤.       
ObjectProvider ëŠ” ì§€ê¸ˆ ë”± í•„ìš”í•œ DL ì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µí•˜ê³  ìˆë‹¤.      
      
ì°¸ê³ ë¡œ, `ObjectProvider` ë“±ì¥ ì´ì „ì—ëŠ” `ObjectFactory`ì´ë¼ëŠ”ê²Œ ìˆì—ˆë‹¤.       
`ObjectFactory`ëŠ” ì§„ì§œ ì˜¤ë¡œì§€ ìˆœìˆ˜ DL ê¸°ëŠ¥ë§Œì„ ì œê³µí•´ì¤€ë‹¤.   
`ObjectProvider`ëŠ” DL ê¸°ëŠ¥ ì™¸ì—ë„ 
   
**íŠ¹ì§•**   
ObjectFactory: ê¸°ëŠ¥ì´ ë‹¨ìˆœ, ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš” ì—†ìŒ, ìŠ¤í”„ë§ì— ì˜ì¡´   
ObjectProvider: ObjectFactory ìƒì†, ì˜µì…˜, ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ë“± í¸ì˜ ê¸°ëŠ¥ì´ ë§ê³ , ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”ì—†ìŒ, ìŠ¤í”„ë§ì— ì˜ì¡´    
   
ì•ì„œ, `ObjectProvider` ì˜ `getObject()`ëŠ” ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ì§€ë§Œ, ë‹¨ìœ„í…ŒìŠ¤íŠ¸ê°€ ëœë‹¤ê³  í–ˆë‹¤.         
í•˜ì§€ë§Œ, ê²°êµ­ì—ëŠ” ìŠ¤í”„ë§ì— ì˜ì¡´ëœ ìƒíƒœì´ë¯€ë¡œ ìˆœìˆ˜ ìë°”ë¡œë§Œ ì´ì–´ì§„ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê¸°ëŠ” í˜ë“¤ ê²ƒì´ë‹¤.        
             
## JSR-330 Provider    
ìˆœìˆ˜ ìë°” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ í•˜ë‚˜ì¸ `javax`ì—ì„œë„ `Provider`ë¥¼ ì œê³µí•œë‹¤.            
ì •í™•íˆ ë§í•˜ë©´, `javax.inject:javax.inject:1` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ `gradle`ì— ì¶”ê°€í•´ì•¼ í•˜ì§€ë§Œ,          
`javax.inject.Provider` ë¼ëŠ” `JSR-330` **ìë°” í‘œì¤€**ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.         

```java

    @Scope("singleton")
    static class ClientBean {

        private final Provider<PrototypeBean> objectProvider;

        @Autowired
        public ClientBean(Provider<PrototypeBean> objectProvider) {
            this.objectProvider = objectProvider;
        }

        public int logic() {
            PrototypeBean prototypeBean = objectProvider.get();
            prototypeBean.addCount();
            return prototypeBean.getCount();
        }

    }
```
`provider.get()`ì€ ë‚´ë¶€ì—ì„œëŠ” ì»¨í…Œì´ë„ˆì—ì„œ í•´ë‹¹ ë¹ˆì„ ì°¾ì•„ì„œ ë°˜í™˜í•œë‹¤. (DL)          
**ìë°” í‘œì¤€**ì´ê³ , ê¸°ëŠ¥ì´ ë‹¨ìˆœí•˜ë¯€ë¡œ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ê±°ë‚˜ mock ì½”ë“œë¥¼ ë§Œë“¤ê¸°ëŠ” í›¨ì”¬ ì‰¬ì›Œì§„ë‹¤.        
Provider ëŠ” ì§€ê¸ˆ ë”± í•„ìš”í•œ `DL` ì •ë„ì˜ ê¸°ëŠ¥ë§Œ ì œê³µí•œë‹¤.          
          
**ê·¸ë ‡ë‹¤ë©´ ì™œ? `javax.inject.Provider`ë¥¼ ì‚¬ìš©í• ê¹Œ? ğŸ¤”**        
ì•ì„  `ObjectProvider`ëŠ” ìŠ¤í”„ë§ì—ì„œ ì œê³µë˜ëŠ”, ìŠ¤í”„ë§ì— ì˜ì¡´ì ì¸ `Proivider`ì˜€ë‹¤.      
í•˜ì§€ë§Œ, `javax.inject.Provider`ëŠ” ìë°” í‘œì¤€ì´ê¸°ì—    
ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ í”„ë ˆì„ì›Œí¬ì˜ ì»¨í…Œì´ë„ˆì˜ `DL`ì„ ì§€ì›í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.  
      
**íŠ¹ì§•**   
* `get()` ë©”ì„œë“œ í•˜ë‚˜ë¡œ ê¸°ëŠ¥ì´ ë§¤ìš° ë‹¨ìˆœí•˜ë‹¤.     
* ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”í•˜ë‹¤.    
* ìë°” í‘œì¤€ì´ë¯€ë¡œ ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.    

      
**í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì–¸ì œ ì‚¬ìš©í• ê¹Œ?ğŸ¤”**        
ì‚¬ìš©í•  ë•Œ ë§ˆë‹¤ ìƒˆë¡œìš´ ê°ì²´ê°€ í•„ìš”í•œ ê²½ìš°ì— ì‚¬ìš©ëœë‹¤.            
ê·¸ëŸ°ë° ì‹¤ë¬´ì—ì„œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•´ë³´ë©´,           
ì‹±ê¸€í†¤ ë¹ˆìœ¼ë¡œ ëŒ€ë¶€ë¶„ì˜ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í”„ë¡œí† íƒ€ì… ë¹ˆì„ ì§ì ‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì¼ì€ ë§¤ìš° ë“œë¬¼ë‹¤.        
`ObjectProvider , JSR330 Provider` ë“±ì€ í”„ë¡œí† íƒ€ì… ë¿ë§Œ ì•„ë‹ˆë¼        
DLì´ í•„ìš”í•œ ê²½ìš°, ì¦‰ ì–´ë–¤ ë¹ˆì´ë“ ì§€ê°„ì— ì–¸ì œë“ ì§€ DL ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.          
íŠ¹ì • ì¼€ì´ìŠ¤ë¡œ ë§í•˜ìë©´,         
ì§€ì—°ì—ì„œ ê°€ì ¸ì˜¤ê±°ë‚˜ ì˜µì…”ë„í•˜ê²Œ ê°€ì ¸ì˜¬ ë•Œ,       
ìˆœí™˜ ì˜ì¡´ ê´€ê³„ê°€ ë°œìƒí–ˆì„ ë•Œ(Aê°€ Bë¥¼ ì°¸ì¡°í•´ë„ Bê°€ Aë¥¼ ë‚˜ì¤‘ì— ì°¸ì¡°í•  ë•Œ)ì´ë‹¤.          
          
**ì°¸ê³ **         
* ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ë©”ì„œë“œì— `@Lookup` ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆì§€ë§Œ,        
  ì´ì „ ë°©ë²•ë“¤ë¡œ ì¶©ë¶„í•˜ê³ , ê³ ë ¤í•´ì•¼í•  ë‚´ìš©ë„ ë§ì•„ì„œ ìƒëµí•˜ê² ë‹¤.       
* ìë°” í‘œì¤€ì¸ JSR-330 Providerë¥¼ ì‚¬ìš©í•  ê²ƒì¸ì§€, ì•„ë‹ˆë©´ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ObjectProviderë¥¼ ì‚¬ìš©í•  ê²ƒì¸ì§€ ê³ ë¯¼ì´ ë  ê²ƒì´ë‹¤.        
  ObjectProviderëŠ” DLì„ ìœ„í•œ í¸ì˜ ê¸°ëŠ¥ì„ ë§ì´ ì œê³µí•´ì£¼ê³  ìŠ¤í”„ë§ ì™¸ì— ë³„ë„ì˜ ì˜ì¡´ê´€ê³„ ì¶”ê°€ê°€ í•„ìš” ì—†ê¸° ë•Œë¬¸ì— í¸ë¦¬í•˜ë‹¤.         
  ë§Œì•½ ì½”ë“œë¥¼ ìŠ¤í”„ë§ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ë©´ JSR-330 Providerë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.        
  (í•˜ì§€ë§Œ, ê·¸ëŸ´ì¼ì€ ê±°ì˜ ì—†ë‹¤.)               
* ìŠ¤í”„ë§ì„ ì‚¬ìš©í•˜ë‹¤ ë³´ë©´ ì´ ê¸°ëŠ¥ ë¿ë§Œ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ê¸°ëŠ¥ë“¤ë„ ìë°” í‘œì¤€ê³¼ ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ ê²¹ì¹ ë•Œê°€ ë§ì´ ìˆë‹¤.         
  ëŒ€ë¶€ë¶„ ìŠ¤í”„ë§ì´ ë” ë‹¤ì–‘í•˜ê³  í¸ë¦¬í•œ ê¸°ëŠ¥ì„ ì œê³µí•´ì£¼ê¸° ë•Œë¬¸ì—,     
  íŠ¹ë³„íˆ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•  ì¼ì´ ì—†ë‹¤ë©´, ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.           

# ì›¹ ìŠ¤ì½”í”„
ì›¹ ìŠ¤ì½”í”„ëŠ” ë¹ˆ ìŠ¤ì½”í”„ ì¤‘ì—ì„œ ì›¹ í™˜ê²½ì—ì„œë§Œ ë™ì‘ì„ í•œë‹¤.     
ê·¸ë ‡ê¸°ì— í”„ë¡œí† íƒ€ì…ê³¼ëŠ” ë‹¤ë¥´ê²Œ ìŠ¤í”„ë§ì´ í•´ë‹¹ ìŠ¤ì½”í”„ì˜ ì¢…ë£Œì‹œì ê¹Œì§€ ê´€ë¦¬í•œë‹¤ëŠ” íŠ¹ì§•ì´ ìˆë‹¤.   
     
**ì›¹ ìŠ¤ì½”í”„ ì¢…ë¥˜**   
* **request:** HTTP ìš”ì²­ í•˜ë‚˜ê°€ ë“¤ì–´ì˜¤ê³  ë‚˜ê°ˆ ë•Œê¹Œì§€ ìœ ì§€ë˜ë©°, HTTP ìš”ì²­ë§ˆë‹¤ ë³„ë„ì˜ ë¹ˆ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ê³  ê´€ë¦¬ëœë‹¤.   
* **session:** HTTP Sessionê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„   
* **application:** ì„œë¸”ë¦¿ ì»¨í…ìŠ¤íŠ¸(ServletContext)ì™€ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„     
* **websocket:** ì›¹ ì†Œì¼“ê³¼ ë™ì¼í•œ ìƒëª…ì£¼ê¸°ë¥¼ ê°€ì§€ëŠ” ìŠ¤ì½”í”„  
   
# Request ìŠ¤ì½”í”„ 
`Request ìŠ¤ì½”í”„`ì— ëŒ€í•´ì„œ ê°„ë‹¨íˆ ìˆ™ì§€í•˜ê³  ìˆìœ¼ë¯€ë¡œ ì½”ë“œë¥¼ í†µí•´ ì•Œì•„ë³´ì        
   
   
**build.gradle**
```gradle   
plugins {
    id 'org.springframework.boot' version '2.4.4'
    id 'io.spring.dependency-management' version '1.0.11.RELEASE'
    id 'java'
}

group = 'hello'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = '1.8'

repositories {
    mavenCentral()
}

configurations {
    compileJava {
        extendsFrom annotationProcessor
    }
}

dependencies {

    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.projectlombok:lombok'
    implementation 'javax.inject:javax.inject:1'

    compileOnly'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'

    testCompileOnly'org.projectlombok:lombok'
    testAnnotationProcessor 'org.projectlombok:lombok'

    implementation 'org.springframework.boot:spring-boot-starter'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

test {
    useJUnitPlatform()
}
```   
`spring-boot-starter-web` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•˜ë©´ì„œ    
ìŠ¤í”„ë§ê³¼ ë‚´ì¥ í†°ì¼“ ì„œë²„ë¥¼ í•¨ê»˜ ì‹¤í–‰ì‹œí‚¤ë„ë¡ ë§Œë“¤ì—ˆë‹¤.     
        
**ì°¸ê³ ë¡œ,**      
ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” 'ì›¹ ë¼ì´ë¸ŒëŸ¬ë¦¬'ê°€ ì—†ìœ¼ë©´        
`AnnotationConfigApplicationContext`ì„ ê¸°ë°˜ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ë™í•œë‹¤.     
ë°˜ë©´ì—, 'ì›¹ ë¼ì´ë¸ŒëŸ¬ë¦¬'ê°€ ì¡´ì¬í•œë‹¤ë©´            
ì›¹ê³¼ ê´€ë ¨ëœ ì¶”ê°€ ì„¤ì •ê³¼ í™˜ê²½ë“¤ì´ í•„ìš”í•˜ê¸°ì—               
`AnnotationConfigServletWebServerApplicationContext`ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ë™í•œë‹¤.        
     
ê·¸ë¦¬ê³  ë§Œì•½, ê¸°ì¡´ì— 8080í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ í”„ë¡œí¼í‹°ë¥¼ í†µí•´ ì„œë²„ í¬íŠ¸ë¥¼ ë³€ê²½ì‹œí‚¬ ìˆ˜ ìˆë‹¤.    
**main/resources/application.properties**
```properties
server.port=9090
```
       
ì´ì œ ìš°ë¦¬ëŠ” `@Scope(value = "request")`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.          
ë‹¨, `request ìŠ¤ì½”í”„`ë¥¼ ì‚¬ìš©í•˜ê¸° ì´ì „ì— **ì™œ? ê·¸ë¦¬ê³  ì–¸ì œ? ì‚¬ìš©í•˜ëŠ”ì§€ ì•Œì•„ë³´ì ğŸ¤”**     
      
`request ìŠ¤ì½”í”„`ë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€í‘œì ì¸ ì˜ˆë¡œ **ë¡œê·¸**ê°€ ìˆë‹¤.       
ì—¬ëŸ¬ HTTP ìš”ì²­ì´ ë™ì‹œì— ì˜¤ë©´ ì •í™•íˆ ì–´ë–¤ ìš”ì²­ì´ ë‚¨ê¸´ ë¡œê·¸ì¸ì§€ êµ¬ë¶„í•˜ê¸° ì–´ë µë‹¤.       
`request ìŠ¤ì½”í”„`ëŠ” ì´ëŸ´ë•Œ ì‚¬ìš©í•˜ê¸° ë”± ì¢‹ë‹¤.       
            
ì•„ë˜ì™€ ê°™ì´ ë¡œê·¸ê°€ ë‚¨ë„ë¡ `request ìŠ¤ì½”í”„`ë¥¼ í™œìš©í•´ì„œ ì¶”ê°€ ê¸°ëŠ¥ì„ ê°œë°œí•´ë³´ì.        
```
[d06b992f...] request scope bean create
[d06b992f...][http://localhost:8080/log-demo] controller test[d06b992f...][http://localhost:8080/log-demo] service id = testId
[d06b992f...] request scope bean close
```
* ê¸°ëŒ€í•˜ëŠ” ê³µí†µ í¬ë©§: `[UUID][requestURL] {message}`   
* UUIDë¥¼ ì‚¬ìš©í•´ì„œ HTTP ìš”ì²­ì„ êµ¬ë¶„í•˜ì.        
* requestURL ì •ë³´ë„ ì¶”ê°€ë¡œ ë„£ì–´ì„œ ì–´ë–¤ URLì„ ìš”ì²­í•´ì„œ ë‚¨ì€ ë¡œê·¸ì¸ì§€ í™•ì¸í•˜ì.     
     
**MyLogger**
```java
package hello.core.common;

import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Component;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;
import java.util.UUID;

@Scope(value = "request")
@Component
public class MyLogger {

    private String uuid;
    private String requestURL;

    public void setRequestURL(String requestURL) {
        this.requestURL = requestURL;
    }

    public void log(String message) {
        System.out.println("[" + uuid + "]" + "[" + requestURL + "]" + message);
    }

    @PostConstruct
    public void init() {
        uuid = UUID.randomUUID().toString();
        System.out.println("[" + uuid + "] request scope bean create:" + this);
    }

    @PreDestroy
    public void close() {
        System.out.println("[" + uuid + "] request scope bean create:" + this);
    }
}
```
ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‚¬ìš©ìì˜ requestì‹œ ë¡œê·¸ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•œ MyLogger í´ë˜ìŠ¤ì´ë‹¤.
`@Scope(value = "request")`ë¥¼ ì‚¬ìš©í•´ì„œ `request ìŠ¤ì½”í”„`ë¡œ ì§€ì •í–ˆë‹¤.    
ì´ì œ ì´ ë¹ˆì€ `HTTP ìš”ì²­ ë‹¹ í•˜ë‚˜ì”© ìƒì„±`ë˜ê³ , `HTTP ìš”ì²­ì´ ëë‚˜ëŠ” ì‹œì ì— ì†Œë©¸`ëœë‹¤.    
      
ì´ ë¹ˆì´ ìƒì„±ë˜ëŠ” ì‹œì ì— ìë™ìœ¼ë¡œ `@PostConstruct` ì´ˆê¸°í™” ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ `uuid`ë¥¼ ìƒì„±í•´ì„œ ì €ì¥í•´ë‘”ë‹¤.     
ì´ ë¹ˆì€ HTTP ìš”ì²­ ë‹¹ í•˜ë‚˜ì”© ìƒì„±ë˜ë¯€ë¡œ, uuidë¥¼ ì €ì¥í•´ë‘ë©´ ë‹¤ë¥¸ HTTP ìš”ì²­ê³¼ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.    
ì´ ë¹ˆì´ ì†Œë©¸ë˜ëŠ” ì‹œì ì— `@PreDestroy`ë¥¼ ì‚¬ìš©í•´ì„œ ì¢…ë£Œ ë©”ì‹œì§€ë¥¼ ë‚¨ê¸´ë‹¤.       
`requestURL`ì€ ì´ ë¹ˆì´ ìƒì„±ë˜ëŠ” ì‹œì ì—ëŠ” ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ì™¸ë¶€ì—ì„œ setterë¡œ ì…ë ¥ ë°›ëŠ”ë‹¤.      
    
**LogDemoController**
```java
package hello.core.web;

import hello.core.common.MyLogger;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import javax.servlet.http.HttpServletRequest;

@RequiredArgsConstructor
@Controller
public class LogDemoController {

    private final LogDemoService logDemoService;
    private final MyLogger myLogger;

    @RequestMapping("log-demo")
    @ResponseBody
    public String logDemo(HttpServletRequest request) {
        String requestUrl = request.getRequestURI().toString();
        myLogger.setRequestURL(requestUrl);

        myLogger.log("Controller Test");
        logDemoService.logic("testId");
        return "OK";
    }

}
```
ë¡œê±°ê°€ ì˜ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ìš© ì»¨íŠ¸ë¡¤ëŸ¬ë‹¤.    
`HttpServletRequest`ë¥¼ í†µí•´ì„œ ìš”ì²­ `URL`ì„ ë°›ì•˜ë‹¤.  
(requestURL ê°’ `http://localhost:8080/log-demo`)  
ì´ë ‡ê²Œ ë°›ì€ requestURL ê°’ì„ myLoggerì— ì €ì¥í•´ë‘”ë‹¤.      
myLoggerëŠ” HTTP ìš”ì²­ ë‹¹ ê°ê° êµ¬ë¶„ë˜ë¯€ë¡œ ë‹¤ë¥¸ HTTP ìš”ì²­ ë•Œë¬¸ì— ê°’ì´ ì„ì´ëŠ” ê±±ì •ì€ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.     
ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ controller testë¼ëŠ” ë¡œê·¸ë¥¼ ë‚¨ê¸´ë‹¤.       
     
**ì°¸ê³ ë¡œ,**      
`requestURL`ì„ `MyLogger`ì— ì €ì¥í•˜ëŠ” ë¶€ë¶„ì€ ì»¨íŠ¸ë¡¤ëŸ¬ ë³´ë‹¤ëŠ”        
ê³µí†µ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•œ ìŠ¤í”„ë§ ì¸í„°ì…‰í„°ë‚˜ ì„œë¸”ë¦¿ í•„í„° ê°™ì€ ê³³ì„ í™œìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.         
ìŠ¤í”„ë§ ì›¹ì— ìµìˆ™í•˜ë‹¤ë©´ ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•´ì„œ êµ¬í˜„í•´ë³´ì       
     
**LogDemoService**
```java
package hello.core.web;

import hello.core.common.MyLogger;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

@RequiredArgsConstructor
@Service
public class LogDemoService {

    private final MyLogger myLogger;

    public void logic(String id) {
        myLogger.log("service id = " + id);
    }
}
```
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìˆëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µì—ì„œë„ ë¡œê·¸ë¥¼ ì¶œë ¥í•´ë³´ì.      
ì—¬ê¸°ì„œ ì¤‘ìš”í•œì ì´ ìˆë‹¤.       
`request ìŠ¤ì½”í”„`ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  íŒŒë¼ë¯¸í„°ë¡œ ì´ ëª¨ë“  ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ ê³„ì¸µì— ë„˜ê¸´ë‹¤ë©´, íŒŒë¼ë¯¸í„°ê°€ ë§ì•„ì„œ ì§€ì €ë¶„í•´ì§„ë‹¤.         
ë” ë¬¸ì œëŠ” `requestURL` ê°™ì€ ì›¹ê³¼ ê´€ë ¨ëœ ì •ë³´ê°€ ì›¹ê³¼ ê´€ë ¨ì—†ëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µê¹Œì§€ ë„˜ì–´ê°€ê²Œ ëœë‹¤.       
     
**ì›¹ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ì€ ì»¨íŠ¸ë¡¤ëŸ¬ê¹Œì§€ë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.**         
ì„œë¹„ìŠ¤ ê³„ì¸µì€ ì›¹ ê¸°ìˆ ì— ì¢…ì†ë˜ì§€ ì•Šê³ , ê°€ê¸‰ì  ìˆœìˆ˜í•˜ê²Œ ìœ ì§€í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ ê´€ì ì—ì„œ ì¢‹ë‹¤.     
request scopeì˜ MyLogger ë•ë¶„ì— ì´ëŸ° ë¶€ë¶„ì„ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ì§€ ì•Šê³ ,      
MyLoggerì˜ ë©¤ë²„ë³€ìˆ˜ì— ì €ì¥í•´ì„œ ì½”ë“œì™€ ê³„ì¸µì„ ê¹”ë”í•˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.    
               
ì ì´ì œ, ìš°ë¦¬ê°€ ìƒê°í•œëŒ€ë¡œ ì½”ë“œë¥¼ êµ¬í˜„ì„ í•´ë³´ì•˜ìœ¼ë‹ˆ ì‹¤í–‰í•´ë³´ì    
```java
Error creating bean with name 'myLogger': Scope 'request' is not active for the 
current thread; consider defining a scoped proxy for this bean if you intend to 
refer to it from a singleton;
```
í•˜ì§€ë§Œ, ì§ì ‘ ì‹¤í–‰ì„ ëŒë ¤ì„œ í™•ì¸í•˜ê³ ì í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.   
**ì»´íŒŒì¼ ë¬¸ì œë„ ì—†ê³ , ë…¼ë¦¬ íë¦„ë„ ë§ëŠ” ê²ƒ ê°™ì€ë° ì™œ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€? ğŸ¤”**    
ì•„ì´ëŸ¬ë‹ˆí•˜ê²Œë„ ì—ëŸ¬ê°€ ë°œìƒí•œ ì´ìœ ëŠ” **requset ìŠ¤ì½”í”„** ë•Œë¬¸ì´ë‹¤.   
      
**requset ìŠ¤ì½”í”„**ëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ìˆì–´ì•¼ ìƒì„±ë˜ëŠ” ë¹ˆì´ë‹¤.       
ë°˜ë©´ì—, `LogDemoController`ì™€ `LogDemoService`ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ì‹œ ìƒì„±ë˜ëŠ” ë¹ˆì´ë‹¤.     
ì¦‰ ìƒì„± ì‹œì ì˜ ë¶ˆì¼ì¹˜ë¡œ ì¸í•˜ì—¬ ë¹ˆì´ ì£¼ì… ë˜ì§€ ëª»í•˜ê¸°ì— ë°œìƒí•˜ëŠ” ì—ëŸ¬ì´ë‹¤.     
   
ì•„ì£¼ ë‚œê°í•œ ì—ëŸ¬ì´ë‹¤.     
`requset ìŠ¤ì½”í”„`ë¥¼ ì‚¬ìš©í•˜ê³ ì í•˜ì§€ë§Œ, `requset ìŠ¤ì½”í”„` ë•Œë¬¸ì— ì—ëŸ¬ê°€ ë°œìƒí•˜ë‹ˆ ë§ì´ë‹¤.     
ê·¸ë ‡ë‹¤ë©´ **ì–´ë–»ê²Œ í•´ì•¼ ì´ ë¬¸ì œë¥¼ í•´ê²°í• ê¹Œ? ğŸ¤”**        
  
ì •ë‹µì€ ì‹¬í”Œí•˜ë‹¤.    
ìš°ë¦¬ê°€ ë°°ì› ë˜ `Provider`ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤!!!     
 
 












