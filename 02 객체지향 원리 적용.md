# ê°ì²´ì§€í–¥ ì›ë¦¬ ì ìš©
## ìƒˆë¡œìš´ í• ì¸ ì •ì±… ê°œë°œ    
* **ì•…ë• ê¸°íšìž :** 
  ì„œë¹„ìŠ¤ ì˜¤í”ˆ ì§ì „ì— í• ì¸ ì •ì±…ì„ ì§€ê¸ˆì²˜ëŸ¼ ê³ ì • ê¸ˆì•¡ í• ì¸ì´ ì•„ë‹ˆë¼    
  ì¢€ ë” í•©ë¦¬ì ì¸ ì£¼ë¬¸ ê¸ˆì•¡ë‹¹ í• ì¸í•˜ëŠ” ì •ë¥  í• ì¸ìœ¼ë¡œ ë°”ê¾¸ê³  ì‹¶ì–´ìš” 
  ì˜ˆë¥¼ ë“¤ë©´, VIPëŠ” 10% í• ì¸ì„ ì‹œì¼œì£¼ëŠ”ê±°ì£    
* **ìˆœì§„ ê°œë°œìž :**   
  ì²˜ìŒ ë¶€í„° ê·¸ê±´ ì•„ë‹ˆë¼ê³  í–ˆìž–ì•„ìš”...
* **ì•…ë• ê¸°íšìž :**    
  **[ì• ìžì¼ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ì„ ì–¸](https://agilemanifesto.org/iso/ko/manifesto.html) ëª°ë¼ìš”? ê³„íšì„ ë”°ë¥´ê¸°ë³´ë‹¤ëŠ” ë³€í™”ì— ëŒ€ì‘í•˜ê¸°ë¥¼..**   
      
ì´ì „ì— ìž‘ì„±í–ˆë˜ `DiscountPolicy` ì¸í„°íŽ˜ì´ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, `DiscountPolicy` í´ëž˜ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤.       

**DiscountPolicy êµ¬í˜„**
```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class RateDiscountPolicy implements DiscountPolicy{

    private int discountPercent = 10;

    @Override
    public int discount(Member member, int price) {
        if(member.getGrade() == Grade.VIP){
            return price * discountPercent / 100;
        }
        return 0;
    }
}
```
   
**DiscountPolicy í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ DiscountPolicyTest êµ¬í˜„**    
```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.*;

class RateDiscountPolicyTest {

    DiscountPolicy discountPolicy = new RateDiscountPolicy();


    @Test
    @DisplayName("VIPëŠ” 10% í• ì¸ì´ ì ìš©ë˜ì–´ì•¼ í•œë‹¤")
    void vip_o() {
        // given
        Member member = new Member(1L, "memberVIP", Grade.VIP);

        // when
        int discount = discountPolicy.discount(member, 10000);

        // then
        assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIPê°€ ì•„ë‹ˆë©´ 10% í• ì¸ì´ ì ìš©ë˜ì§€ ì•Šì•„ì•¼ í•œë‹¤")
    void vip_x() {
        // given
        Member member = new Member(2L, "memberVIP", Grade.BASIC);

        // when
        int discount = discountPolicy.discount(member, 10000);

        // then
        assertThat(discount).isEqualTo(0);
    }
}
```

## ìƒˆë¡œìš´ í• ì¸ ì •ì±… ì ìš©ê³¼ ë¬¸ì œì   
ìƒˆë¡œìš´ í• ì¸ ì •ì±…ì„ ì ìš©í•˜ê¸° ìœ„í•´, `OrderServiceImpl` ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³ ìž í•œë‹¤.   

**ë³€ê²½ ì „**
```java
    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
```
   
**ë³€ê²½ í›„**
```java
    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
```

í•˜ì§€ë§Œ, ë§Œì•½ ì´ì™€ ê°™ì€ ì½”ë“œê°€ 100ê°œ, 1000ê°œ, 10000ê°œê°€ ìžˆë‹¤ë©´...?   
ì´ê°™ì´ ì£¼ì„ì„ ì²˜ë¦¬í•˜ê³  ìƒˆë¡œìš´ í´ëž˜ìŠ¤ë¥¼ ë„£ì–´ì£¼ëŠ” ìž‘ì—…ì„ ì¼ì¼ížˆ ë‹¤ í•´ì•¼í•œë‹¤.    

**ë¬¸ì œì  ë°œê²¬**   
* ìš°ë¦¬ëŠ” ì—­í• ê³¼ êµ¬í˜„ì„ ì¶©ì‹¤í•˜ê²Œ ë¶„ë¦¬í–ˆë‹¤ -> OK  
* ë‹¤í˜•ì„±ë„ í™œìš©í•˜ê³ , ì¸í„°íŽ˜ì´ìŠ¤ì™€ êµ¬í˜„ì²´ë¥¼ ë¶„ë¦¬í–ˆë‹¤ -> OK
* OCP, DIP ê°™ì€ ê°ì²´ì§€í–¥ ì„¤ê³„ ì›ì¹™ì„ ì¶©ì‹¤ížˆ ì¤€ìˆ˜í–ˆë‹¤. -> âŒ ê·¸ë ‡ê²Œ ë³´ì´ì§€ë§Œ ì•„ë‹ˆë‹¤.     
* DIP: ì£¼ë¬¸ ì„œë¹„ìŠ¤ í´ë¼ì´ì–¸íŠ¸ `OrderServiceImpl`ëŠ” `DiscountPolicy` ì¸í„°íŽ˜ì´ìŠ¤ì— ì˜ì¡´í•˜ê³  ìžˆë‹¤.  
  * í´ëž˜ìŠ¤ ì˜ì¡´ê´€ê³„ë¥¼ ì‚´íŽ´ë³´ë©´, ì¸í„°íŽ˜ì´ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ êµ¬í˜„ í´ëž˜ìŠ¤ë„ ì˜ì¡´í•˜ê³  ìžˆë‹¤.   
  * ì´ë¥¼ ì¢€ ë” ì‰½ê²Œ í‘œí˜„í•˜ë©´ êµ¬í˜„ì²´ê°€ ì–´ë–¤ êµ¬í˜„ì²´ì¸ì§€ ì •í™•ížˆ ì•Œê³  ìžˆëŠ” ìƒíƒœì´ë‹¤(new í–ˆìœ¼ë‹ˆ)    
    * ì¶”ìƒ ì¸í„°íŽ˜ì´ìŠ¤ ì˜ì¡´ : DiscountPolicy
    * êµ¬í˜„ í´ëž˜ìŠ¤ ì˜ì¡´ : FixDiscountPolicy, RateDiscountPolicy
* OCP : ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³  ê¸°ëŠ¥ì„ ë³€ê²½, ì½”ë“œë¥¼ í™•ìž¥í•  ìˆ˜ ìžˆë‹¤ëŠ” ê°œë…         
  * ì§€ê¸ˆ ì½”ë“œëŠ” ê¸°ëŠ¥ì„ í™•ìž¥í•˜ë©´, í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤. ë”°ë¼ì„œ **OCPë¥¼ ìœ„ë°˜**í•œë‹¤.     
      
**ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ í•´ê²°í• ê¹Œ?ðŸ¤”**   
í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì¸ `OrderServiceImpl` ì€      
`DiscountPolicy` ì¸í„°íŽ˜ì´ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ êµ¬í˜„ í´ëž˜ìŠ¤ë„ í•¨ê»˜ ì˜ì¡´í•œë‹¤.     
ê·¸ëž˜ì„œ êµ¬ì²´ í´ëž˜ìŠ¤ë¥¼ ë³€ê²½í•  ë•Œ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë„ í•¨ê»˜ ë³€ê²½í•œë‹¤.    
  
ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ í•´ê²°í• ê¹Œ? ì¸í„°íŽ˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì˜ì¡´ê´€ê³„ë¥¼ ë³€ê²½í•˜ë©´ ëœë‹¤.     
* **DIP ìœ„ë°˜** -> ì¶”ìƒì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ë³€ê²½í•œë‹¤.(ì¸í„°íŽ˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´)      
    
**ì¸í„°íŽ˜ì´ìŠ¤ë§Œ ì˜ì¡´ ì½”ë“œ**
```java
public class OrderServiceImpl {
    ...
    private final DiscountPolicy discountPolicy;

    ...
}
```
* ì¸í„°íŽ˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•˜ë„ë¡ ì½”ë“œë¥¼ êµ¬í˜„í–ˆë‹¤.  
* í•˜ì§€ë§Œ êµ¬í˜„ì²´ë¥¼ í• ë‹¹ì‹œí‚¤ì§€ ì•Šì•„ì„œ `NullPointerException` ì´ ë°œìƒí•œë‹¤.   
  
**í•´ê²° ë°©ì•ˆ**    
ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´,      
ëˆ„êµ°ê°€ í´ë¼ì´ì–¸íŠ¸ì¸ `OrderServiceImpl`ì—     
`DiscountPolicy`ì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ê³  ì£¼ìž…í•´ì£¼ì–´ì•¼ í•œë‹¤.     

## ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬  
ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í•˜ë‚˜ì˜ ë¡œë¯¸ì˜¤ì™€ ì¤„ë¦¬ì—£ ê³µì—°ì´ë¼ ìƒê°í•˜ìž.       
ë¡œë¯¸ì˜¤ì™€ ì¤„ë¦¬ì—£ì€ ëˆ„ê°€ ë˜ë˜ì§€ ê³µì—°ë§Œ ìž˜ ë§ˆë¬´ë¦¬í•˜ë©´ ìƒê´€ì´ ì—†ë‹¤.      
í•˜ì§€ë§Œ, í•œ ê°€ì§€ ìš°ë¦¬ëŠ” ê°„ê³¼í•˜ê³  ìžˆëŠ” ì‚¬ì‹¤ì´ ìžˆë‹¤.        
ë¡œë¯¸ì˜¤ì™€ ì¤„ë¦¬ì—£ **ë°°ì—­ì„ ë§¡ì„ ë°°ìš°ëŠ” ëˆ„ê°€ ì •í•´ì£¼ëŠ” ê²ƒì¸ê°€?**        

ë§Œì•½ ë¡œë¯¸ì˜¤ ì—­í• ì„ ë§¡ëŠ” ë””ì¹´í”„ë¦¬ì˜¤ê°€ ì´ê°™ì€ ì—­í• ì„ í•œë‹¤ê³  ê°€ì •í•´ë³´ë©´ 
ë¡œë¯¸ì˜¤ëŠ” ì•„ëž˜ì™€ ê°™ì€ ì—­í• ê³¼ ì±…ìž„ì„ ê°€ì§„ë‹¤.  

* ì‹¤ì œ ì—°ê·¹ì„ ìˆ˜í–‰í•  ë¡œë¯¸ì˜¤ ì—­í•  
* ë°°ìš°ë¥¼ ì„­ì™¸í•˜ê³  ë°°ì—­ì„ ì§€ì •í•´ì£¼ëŠ” ì—­í•   
   
ì´ì™€ ê°™ì€ ì‚¬ì‹¤ë¡œ ë¯¸ë£¨ì–´ë³¼ ë•Œ, ë°°ìš°ê°€ ë°°ì—­ì„ í• ë‹¹í•˜ëŠ” ì—­í• ì„ ë„ë§¡ìœ¼ë©´       
ë‹¤ì–‘í•  ì—­í• ê³¼ ì±…ìž„ì„ ê°€ì§„ í•  ì¼ì´ ë§Žì€ ì‚¬ëžŒì´ ëœë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìžˆë‹¤.    
 
**âœ” ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ìž**     
* ë°°ìš°ëŠ” ë³¸ì¸ì˜ ì—­í• ì¸ ë°°ì—­ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì—ë§Œ ì§‘ì¤‘í•´ì•¼í•œë‹¤.    
* ë°°ìš°ëŠ” ìƒëŒ€ ì—¬ìž ë°°ì—­ë¶„ì´ ì–´ë–¤ ë¶„ì´ ì˜¤ë”ë¼ë„ ì—­í• ì„ ì¶©ì‹¤ížˆ ìˆ˜í–‰í•´ì•¼í•œë‹¤.   
* ê³µì—°ì„ êµ¬ì„±í•˜ê³ , ë‹´ë‹¹ ë°°ìš°ë¥¼ ì„­ì™¸í•˜ê³ , ë°°ìš°ë¥¼ ì§€ì •í•˜ëŠ” ì±…ìž„ì€ **ê³µì—° ê¸°íšìž**ê°€ í•´ì•¼í•  ì¼ì´ë‹¤.  
* ê³µì—° ê¸°íšìžê°€ ì—†ë‹¤ë©´ ì´ë¥¼ ë§Œë“¤ê³ , ë°°ìš°ì™€ ê³µì—° ê¸°íšìžì˜ ì±…ìž„ì„ í™•ì‹¤ížˆ ë¶„ë¦¬í•˜ìž   
  
### AppConfig ë“±ìž¥     
ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë™ìž‘ ë°©ì‹ì„ êµ¬ì„±`(config)`í•˜ê¸° ìœ„í•´,     
**êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**í•˜ê³ , **ì—°ê²°**í•˜ëŠ” ì±…ìž„ì„ ê°€ì§€ëŠ” ë³„ë„ì˜ ì„¤ì • í´ëž˜ìŠ¤ë¥¼ ë§Œë“¤ìž     

```java
package hello.core;

import hello.core.discount.FixDiscountPolicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(new MemoryMemberRepository());
    }

    public OrderService orderService() {
        return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
    }

}
```
`AppConfig`ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ë™ìž‘ì— í•„ìš”í•œ `êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±`í•œë‹¤.       
   
* MemberServiceImpl
* MemoryMemberRepository  
* OrderServiceImpl  
* FixDiscountPolicy  

`AppConfig`ëŠ” ìƒì„±í•œ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ì°¸ì¡°ë¥¼ `ìƒì„±ìžë¥¼ í†µí•´ì„œ ì£¼ìž…`í•´ì¤€ë‹¤.     
* MemberServiceImpl -> MemoryMemberRepository  
* OrderServiceImpl -> MemoryMemberRepository, FixDiscountPolicy   

  




















