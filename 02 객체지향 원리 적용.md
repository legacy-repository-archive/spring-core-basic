# κ°μ²΄μ§€ν–¥ μ›λ¦¬ μ μ©
## μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°    
* **μ•…λ• κΈ°νμ :** 
  μ„λΉ„μ¤ μ¤ν” μ§μ „μ— ν• μΈ μ •μ±…μ„ μ§€κΈμ²λΌ κ³ μ • κΈμ•΅ ν• μΈμ΄ μ•„λ‹λΌ    
  μΆ€ λ” ν•©λ¦¬μ μΈ μ£Όλ¬Έ κΈμ•΅λ‹Ή ν• μΈν•λ” μ •λ¥  ν• μΈμΌλ΅ λ°”κΎΈκ³  μ‹¶μ–΄μ” 
  μλ¥Ό λ“¤λ©΄, VIPλ” 10% ν• μΈμ„ μ‹μΌμ£Όλ”κ±°μ£    
* **μμ§„ κ°λ°μ :**   
  μ²μ λ¶€ν„° κ·Έκ±΄ μ•„λ‹λΌκ³  ν–μ–μ•„μ”...
* **μ•…λ• κΈ°νμ :**    
  **[μ• μμΌ μ†ν”„νΈμ›¨μ–΄ κ°λ° μ„ μ–Έ](https://agilemanifesto.org/iso/ko/manifesto.html) λ°λΌμ”? κ³„νμ„ λ”°λ¥΄κΈ°λ³΄λ‹¤λ” λ³€ν™”μ— λ€μ‘ν•κΈ°λ¥Ό..**   
      
μ΄μ „μ— μ‘μ„±ν–λ `DiscountPolicy` μΈν„°νμ΄μ¤λ¥Ό κΈ°λ°μΌλ΅, `DiscountPolicy` ν΄λμ¤λ¥Ό κµ¬ν„ν•λ‹¤.       

**DiscountPolicy κµ¬ν„**
```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class RateDiscountPolicy implements DiscountPolicy{

    private int discountPercent = 10;

    @Override
    public int discount(Member member, int price) {
        if(member.getGrade() == Grade.VIP){
            return price * discountPercent / 100;
        }
        return 0;
    }
}
```
   
**DiscountPolicy ν…μ¤νΈλ¥Ό μ„ν• DiscountPolicyTest κµ¬ν„**    
```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.*;

class RateDiscountPolicyTest {

    DiscountPolicy discountPolicy = new RateDiscountPolicy();


    @Test
    @DisplayName("VIPλ” 10% ν• μΈμ΄ μ μ©λμ–΄μ•Ό ν•λ‹¤")
    void vip_o() {
        // given
        Member member = new Member(1L, "memberVIP", Grade.VIP);

        // when
        int discount = discountPolicy.discount(member, 10000);

        // then
        assertThat(discount).isEqualTo(1000);
    }

    @Test
    @DisplayName("VIPκ°€ μ•„λ‹λ©΄ 10% ν• μΈμ΄ μ μ©λμ§€ μ•μ•„μ•Ό ν•λ‹¤")
    void vip_x() {
        // given
        Member member = new Member(2L, "memberVIP", Grade.BASIC);

        // when
        int discount = discountPolicy.discount(member, 10000);

        // then
        assertThat(discount).isEqualTo(0);
    }
}
```

## μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ   
μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ μ μ©ν•κΈ° μ„ν•΄, `OrderServiceImpl` μ½”λ“λ¥Ό μμ •ν•κ³ μ ν•λ‹¤.   

**λ³€κ²½ μ „**
```java
    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
```
   
**λ³€κ²½ ν›„**
```java
    private final MemberRepository memberRepository = new MemoryMemberRepository();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
```

ν•μ§€λ§, λ§μ•½ μ΄μ™€ κ°™μ€ μ½”λ“κ°€ 100κ°, 1000κ°, 10000κ°κ°€ μλ‹¤λ©΄...?   
μ΄κ°™μ΄ μ£Όμ„μ„ μ²λ¦¬ν•κ³  μƒλ΅μ΄ ν΄λμ¤λ¥Ό λ„£μ–΄μ£Όλ” μ‘μ—…μ„ μΌμΌν λ‹¤ ν•΄μ•Όν•λ‹¤.    

**λ¬Έμ μ  λ°κ²¬**   
* μ°λ¦¬λ” μ—­ν• κ³Ό κµ¬ν„μ„ μ¶©μ‹¤ν•κ² λ¶„λ¦¬ν–λ‹¤ -> OK  
* λ‹¤ν•μ„±λ„ ν™μ©ν•κ³ , μΈν„°νμ΄μ¤μ™€ κµ¬ν„μ²΄λ¥Ό λ¶„λ¦¬ν–λ‹¤ -> OK
* OCP, DIP κ°™μ€ κ°μ²΄μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ¶©μ‹¤ν μ¤€μν–λ‹¤. -> β κ·Έλ ‡κ² λ³΄μ΄μ§€λ§ μ•„λ‹λ‹¤.     
* DIP: μ£Όλ¬Έ μ„λΉ„μ¤ ν΄λΌμ΄μ–ΈνΈ `OrderServiceImpl`λ” `DiscountPolicy` μΈν„°νμ΄μ¤μ— μμ΅΄ν•κ³  μλ‹¤.  
  * ν΄λμ¤ μμ΅΄κ΄€κ³„λ¥Ό μ‚΄ν΄λ³΄λ©΄, μΈν„°νμ΄μ¤ λΏλ§ μ•„λ‹λΌ κµ¬ν„ ν΄λμ¤λ„ μμ΅΄ν•κ³  μλ‹¤.   
  * μ΄λ¥Ό μΆ€ λ” μ‰½κ² ν‘ν„ν•λ©΄ κµ¬ν„μ²΄κ°€ μ–΄λ–¤ κµ¬ν„μ²΄μΈμ§€ μ •ν™•ν μ•κ³  μλ” μƒνƒμ΄λ‹¤(new ν–μΌλ‹)    
    * μ¶”μƒ μΈν„°νμ΄μ¤ μμ΅΄ : DiscountPolicy
    * κµ¬ν„ ν΄λμ¤ μμ΅΄ : FixDiscountPolicy, RateDiscountPolicy
* OCP : μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³  κΈ°λ¥μ„ λ³€κ²½, μ½”λ“λ¥Ό ν™•μ¥ν•  μ μλ‹¤λ” κ°λ…         
  * μ§€κΈ μ½”λ“λ” κΈ°λ¥μ„ ν™•μ¥ν•λ©΄, ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μν–¥μ„ λ―ΈμΉλ‹¤. λ”°λΌμ„ **OCPλ¥Ό μ„λ°**ν•λ‹¤.     
      
**κ·Έλ ‡λ‹¤λ©΄ μ–΄λ–»κ² ν•΄κ²°ν• κΉ?π¤”**   
ν΄λΌμ΄μ–ΈνΈ μ½”λ“μΈ `OrderServiceImpl` μ€      
`DiscountPolicy` μΈν„°νμ΄μ¤ λΏλ§ μ•„λ‹λΌ κµ¬ν„ ν΄λμ¤λ„ ν•¨κ» μμ΅΄ν•λ‹¤.     
κ·Έλμ„ κµ¬μ²΄ ν΄λμ¤λ¥Ό λ³€κ²½ν•  λ• ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•λ‹¤.    
  
κ·Έλ ‡λ‹¤λ©΄ μ–΄λ–»κ² ν•΄κ²°ν• κΉ? μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μμ΅΄κ΄€κ³„λ¥Ό λ³€κ²½ν•λ©΄ λλ‹¤.     
* **DIP μ„λ°** -> μ¶”μƒμ—λ§ μμ΅΄ν•λ„λ΅ λ³€κ²½ν•λ‹¤.(μΈν„°νμ΄μ¤μ—λ§ μμ΅΄)      
    
**μΈν„°νμ΄μ¤λ§ μμ΅΄ μ½”λ“**
```java
public class OrderServiceImpl {
    ...
    private final DiscountPolicy discountPolicy;

    ...
}
```
* μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“λ¥Ό κµ¬ν„ν–λ‹¤.  
* ν•μ§€λ§ κµ¬ν„μ²΄λ¥Ό ν• λ‹Ήμ‹ν‚¤μ§€ μ•μ•„μ„ `NullPointerException` μ΄ λ°μƒν•λ‹¤.   
  
**ν•΄κ²° λ°©μ•**    
μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ ¤λ©΄,      
λ„κµ°κ°€ ν΄λΌμ΄μ–ΈνΈμΈ `OrderServiceImpl`μ—     
`DiscountPolicy`μ κµ¬ν„ κ°μ²΄λ¥Ό λ€μ‹  μƒμ„±ν•κ³  μ£Όμ…ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.     

## κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬  
μ• ν”λ¦¬μΌ€μ΄μ…μ„ ν•λ‚μ λ΅λ―Έμ¤μ™€ μ¤„λ¦¬μ—£ κ³µμ—°μ΄λΌ μƒκ°ν•μ.       
λ΅λ―Έμ¤μ™€ μ¤„λ¦¬μ—£μ€ λ„κ°€ λλμ§€ κ³µμ—°λ§ μ λ§λ¬΄λ¦¬ν•λ©΄ μƒκ΄€μ΄ μ—†λ‹¤.      
ν•μ§€λ§, ν• κ°€μ§€ μ°λ¦¬λ” κ°„κ³Όν•κ³  μλ” μ‚¬μ‹¤μ΄ μλ‹¤.        
λ΅λ―Έμ¤μ™€ μ¤„λ¦¬μ—£ **λ°°μ—­μ„ λ§΅μ„ λ°°μ°λ” λ„κ°€ μ •ν•΄μ£Όλ” κ²ƒμΈκ°€?**        

λ§μ•½ λ΅λ―Έμ¤ μ—­ν• μ„ λ§΅λ” λ””μΉ΄ν”„λ¦¬μ¤κ°€ μ΄κ°™μ€ μ—­ν• μ„ ν•λ‹¤κ³  κ°€μ •ν•΄λ³΄λ©΄ 
λ΅λ―Έμ¤λ” μ•„λμ™€ κ°™μ€ μ—­ν• κ³Ό μ±…μ„μ„ κ°€μ§„λ‹¤.  

* μ‹¤μ  μ—°κ·Ήμ„ μν–‰ν•  λ΅λ―Έμ¤ μ—­ν•  
* λ°°μ°λ¥Ό μ„­μ™Έν•κ³  λ°°μ—­μ„ μ§€μ •ν•΄μ£Όλ” μ—­ν•  (κ³µμ—° κΈ°νμ) 
   
μ΄μ™€ κ°™μ€ μ‚¬μ‹¤λ΅ λ―Έλ£¨μ–΄λ³Ό λ•, λ°°μ°κ°€ λ°°μ—­μ„ ν• λ‹Ήν•λ” μ—­ν• μ„ λ„λ§΅μΌλ©΄       
λ‹¤μ–‘ν•  μ—­ν• κ³Ό μ±…μ„μ„ κ°€μ§„ ν•  μΌμ΄ λ§μ€ μ‚¬λμ΄ λλ‹¤λ” κ²ƒμ„ μ• μ μλ‹¤.    















